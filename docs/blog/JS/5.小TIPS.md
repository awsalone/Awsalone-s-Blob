## 在离开页面时发送请求
目前最合适的方法：监听unload事件，调用navigatar.sendBeacon方法向服务端发起请求。当用户代理成功把数据加入浏览器传输队列时，`sendBeacon()` 方法将会返回 true，如果受到队列总数、数据大小的限制后，会返回 false。返回true后，只是表示进入了发送队列，浏览器会尽力保证发送成功，但是否成功了，无法判断。
特点：
* 发出的是异步请求，并且是 POST 请求，后端解析参数时，需要注意处理方式；
* 发出的请求，是放到的浏览器任务队列执行的，脱离了当前页面，所以不会阻塞当前页面的卸载和后面页面的加载过程，用户体验较好；
* 只能判断出是否放入浏览器任务队列，不能判断是否发送成功；
Beacon API不提供相应的回调，因此后端返回最好省略response body。

一些其他方法：创建一个图片元素并设置它的 src 属性的方法来延迟卸载以保证数据的发送。因为绝大多数用户代理会延迟卸载以保证图片的载入，所以数据可以在卸载事件中发送。另一种技术是通过创建一个几秒钟的 no-op 循环来延迟卸载并向服务器发送数据。可能会导致页面卡顿，导致非常差的页面载入性能。